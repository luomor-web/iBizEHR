<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper	namespace="cn.ibizlab.ehr.core.orm.mapper.ORMERPORGMapper">

    <!--该方法用于重写mybatis中selectById方法，以实现查询逻辑属性-->
	<select id="selectById"  resultMap="ORMERPORGResultMap" databaseId="mysql">
        <![CDATA[select * from v_ormerporg t1     where  ormerporgid=#{id}]]>
    </select>
	<select id="selectById"  resultMap="ORMERPORGResultMap" databaseId="oracle">
        <![CDATA[select * from v_ormerporg t1     where  ormerporgid=#{id}]]>
    </select>

    <!--通过mybatis将查询结果注入到entity中,通过配置autoMapping="true"由mybatis自动处理映射关系 -->
    <resultMap id="ORMERPORGResultMap" type="cn.ibizlab.ehr.core.orm.domain.ORMERPORG" autoMapping="true">
        <id property="ormerporgid" column="ormerporgid" /><!--主键字段映射-->
            
		
    </resultMap>


    <!--数据集合[CXBM]-->
	 <select id="searchCXBM"  parameterType="cn.ibizlab.ehr.core.orm.filter.ORMERPORGSearchContext"  resultMap="ORMERPORGResultMap">
         select t1.* from (
                <include refid="CXBM" />
         )t1
         <where><if test="ew!=null and ew.sqlSegment!=null and !ew.emptyOfWhere">${ew.sqlSegment}</if></where>
         <if test="ew!=null and ew.sqlSegment!=null and ew.emptyOfWhere">${ew.sqlSegment}</if>
     </select>

    <!--数据集合[LegalChoice]-->
	 <select id="searchLegalChoice"  parameterType="cn.ibizlab.ehr.core.orm.filter.ORMERPORGSearchContext"  resultMap="ORMERPORGResultMap">
         select t1.* from (
                <include refid="LegalChoice" />
         )t1
         <where><if test="ew!=null and ew.sqlSegment!=null and !ew.emptyOfWhere">${ew.sqlSegment}</if></where>
         <if test="ew!=null and ew.sqlSegment!=null and ew.emptyOfWhere">${ew.sqlSegment}</if>
     </select>

    <!--数据集合[Default]-->
	 <select id="searchDefault"  parameterType="cn.ibizlab.ehr.core.orm.filter.ORMERPORGSearchContext"  resultMap="ORMERPORGResultMap">
         select t1.* from (
                <include refid="Default" />
         )t1
         <where><if test="ew!=null and ew.sqlSegment!=null and !ew.emptyOfWhere">${ew.sqlSegment}</if></where>
         <if test="ew!=null and ew.sqlSegment!=null and ew.emptyOfWhere">${ew.sqlSegment}</if>
     </select>

    <!--数据集合[CX]-->
	 <select id="searchCX"  parameterType="cn.ibizlab.ehr.core.orm.filter.ORMERPORGSearchContext"  resultMap="ORMERPORGResultMap">
         select t1.* from (
                <include refid="CX" />
         )t1
         <where><if test="ew!=null and ew.sqlSegment!=null and !ew.emptyOfWhere">${ew.sqlSegment}</if></where>
         <if test="ew!=null and ew.sqlSegment!=null and ew.emptyOfWhere">${ew.sqlSegment}</if>
     </select>

    <!--数据集合[CXZBM]-->
	 <select id="searchCXZBM"  parameterType="cn.ibizlab.ehr.core.orm.filter.ORMERPORGSearchContext"  resultMap="ORMERPORGResultMap">
         select t1.* from (
                <include refid="CXZBM" />
         )t1
         <where><if test="ew!=null and ew.sqlSegment!=null and !ew.emptyOfWhere">${ew.sqlSegment}</if></where>
         <if test="ew!=null and ew.sqlSegment!=null and ew.emptyOfWhere">${ew.sqlSegment}</if>
     </select>

    <!--数据查询[CurFQXJBM]-->
    <sql id="CurFQXJBM" databaseId="mysql">
       <![CDATA[	
			]]>
    </sql>

    <!--数据查询[CurFQXJBM]-->
    <sql id="CurFQXJBM" databaseId="oracle">
       <![CDATA[	SELECT ( substr(t1.ORGCODE,1,3) ) AS ADMCODING, ( select  ormerporgname   from  t_ormerporg  t  where  t.ormerporgid = t1.OUID ) AS BELONGOU, t1.CREATEDATE, t1.CREATEMAN, t1.NUMCOMP, t1.DATEFROM, t1.DATETO, t1.ISENABLE, t1.LASTUPDATEDATE, t1.ORDERNUM, t1.ORGADDRESSLINE1, t1.ORGADDRESSLINE2, t1.ORGADDRESSLINE3, t1.ORGCODE, t1.ORGCREATEDATE, t1.ORGSHORTNAME, t1.ORGTYPE, t1.ORGTYPENAME, t1.ORGZIPCODE, t1.ORMERPORGID, t1.ORMERPORGNAME, t1.OUCODE, t1.OUID, t1.PARENTORGID, t1.TOWNCITY, t1.UPDATEDATE, t1.UPDATEMAN, t1.YYFLAG FROM T_ORMERPORG t1  
				 WHERE 	( (t1.ORGTYPE = 'CCEED6'  or t1.ORGTYPE = 'CCEED9')   and  t1.YYFLAG = 0  and  t1.ISENABLE=1 and  (instr(t1.orgcode,(select a.orgcode from v_ormorg a where a.orgid = #{srf.webcontext.nodeid')}))=1)  and  ( ( substr(t1.ORGCODE,1,3)  in   (select  substr(a.orgcode,1,3)  from  t_srforg  a  where  a.orgid = #{srf.sessioncontext.SRFORGID')}   ) )  or   ('ibzadmin' = (select t.loginaccountname from t_srfloginaccount t where t.loginaccountid = #{srf.sessioncontext.SRFPERSONID')} ) )  or  ( (select substr(a.orgcode, 1, 3)    from t_srforg a  where a.orgid = #{srf.sessioncontext.SRFORGID')} )  in  ('BG','100') )  ) )
			]]>
    </sql>

    <!--数据查询[CurFQXJZBM]-->
    <sql id="CurFQXJZBM" databaseId="mysql">
       <![CDATA[	
			]]>
    </sql>

    <!--数据查询[CurFQXJZBM]-->
    <sql id="CurFQXJZBM" databaseId="oracle">
       <![CDATA[	SELECT ( substr(t1.ORGCODE,1,3) ) AS ADMCODING, ( select  ormerporgname   from  t_ormerporg  t  where  t.ormerporgid = t1.OUID ) AS BELONGOU, t1.CREATEDATE, t1.CREATEMAN, t1.NUMCOMP, t1.DATEFROM, t1.DATETO, t1.ISENABLE, t1.LASTUPDATEDATE, t1.ORDERNUM, t1.ORGADDRESSLINE1, t1.ORGADDRESSLINE2, t1.ORGADDRESSLINE3, t1.ORGCODE, t1.ORGCREATEDATE, t1.ORGSHORTNAME, t1.ORGTYPE, t1.ORGTYPENAME, t1.ORGZIPCODE, t1.ORMERPORGID, t1.ORMERPORGNAME, t1.OUCODE, t1.OUID, t1.PARENTORGID, t1.TOWNCITY, t1.UPDATEDATE, t1.UPDATEMAN, t1.YYFLAG FROM T_ORMERPORG t1  
				 WHERE 	( t1.ORGTYPE = 'CCEED6' and t1.YYFLAG = 0 and t1.ISENABLE=1 and (instr(t1.orgcode,(select substr(a.orgcode,1,5) from v_ormorgsector a where a.orgsectorid = #{srf.webcontext.nodeid')}))=1))
			]]>
    </sql>

    <!--数据查询[CurFQXJZZ]-->
    <sql id="CurFQXJZZ" databaseId="oracle">
       <![CDATA[	SELECT ( substr(t1.ORGCODE,1,3) ) AS ADMCODING, ( select  ormerporgname   from  t_ormerporg  t  where  t.ormerporgid = t1.OUID ) AS BELONGOU, t1.CREATEDATE, t1.CREATEMAN, t1.NUMCOMP, t1.DATEFROM, t1.DATETO, t1.ISENABLE, t1.LASTUPDATEDATE, t1.ORDERNUM, t1.ORGADDRESSLINE1, t1.ORGADDRESSLINE2, t1.ORGADDRESSLINE3, t1.ORGCODE, t1.ORGCREATEDATE, t1.ORGSHORTNAME, t1.ORGTYPE, t1.ORGTYPENAME, t1.ORGZIPCODE, t1.ORMERPORGID, t1.ORMERPORGNAME, t1.OUCODE, t1.OUID, t1.PARENTORGID, t1.TOWNCITY, t1.UPDATEDATE, t1.UPDATEMAN, t1.YYFLAG FROM T_ORMERPORG t1  
				 WHERE 	( ( t1.ORGTYPE = 'CCEED5'   and   t1.YYFLAG = 0  and  t1.ISENABLE=1  and   ( ( substr(t1.ORGCODE,1,3)  )   in   (select  substr(a.orgcode,1,3)  from  t_srforg  a  where  a.orgid = #{srf.sessioncontext.SRFORGID')})))  or  ( ( t1.ORGTYPE in ('CCEED1','CCEED2','CCEED3','CCEED4','CCEED5')   and   t1.YYFLAG = 0  and  t1.ISENABLE=1  and  ( ( 'ibzadmin' = (select t.loginaccountname from t_srfloginaccount t where t.loginaccountid = #{srf.sessioncontext.SRFPERSONID')} ) )   or  ( (select substr(a.orgcode, 1, 3)    from t_srforg a where  a.orgid = #{srf.sessioncontext.SRFORGID')} )  in  ('BG','100') ) ) ) )    ) 
			]]>
    </sql>

    <!--数据查询[CX]-->
    <sql id="CX" databaseId="oracle">
       <![CDATA[	SELECT ( substr(t1.ORGCODE,1,3) ) AS ADMCODING, ( select  ormerporgname   from  t_ormerporg  t  where  t.ormerporgid = t1.OUID ) AS BELONGOU, t1.CREATEDATE, t1.CREATEMAN, t1.NUMCOMP, t1.DATEFROM, t1.DATETO, t1.ISENABLE, t1.LASTUPDATEDATE, t1.ORDERNUM, t1.ORGADDRESSLINE1, t1.ORGADDRESSLINE2, t1.ORGADDRESSLINE3, t1.ORGCODE, t1.ORGCREATEDATE, t1.ORGSHORTNAME, t1.ORGTYPE, t1.ORGTYPENAME, t1.ORGZIPCODE, t1.ORMERPORGID, t1.ORMERPORGNAME, t1.OUCODE, t1.OUID, t1.PARENTORGID, t1.TOWNCITY, t1.UPDATEDATE, t1.UPDATEMAN, t1.YYFLAG FROM T_ORMERPORG t1  
				 WHERE 	( ( t1.ORGTYPE = 'CCEED5'   and  t1.ISENABLE=1  and   ( ( substr(t1.ORGCODE,1,3)  )   in   (select  substr(a.orgcode,1,3)  from  t_srforg  a  where  a.orgid = #{srf.sessioncontext.SRFORGID')})))  or  ( ( t1.ORGTYPE in ('CCEED1','CCEED2','CCEED3','CCEED4','CCEED5')  and  t1.ISENABLE=1  and  ( ( 'ibzadmin' = (select t.loginaccountname from t_srfloginaccount t where t.loginaccountid = #{srf.sessioncontext.SRFPERSONID')} ) )   or  ( (select substr(a.orgcode, 1, 3)    from t_srforg a where  a.orgid = #{srf.sessioncontext.SRFORGID')} )  in  ('BG','100') ) ) ) )    )  
			]]>
    </sql>

    <!--数据查询[CXBM]-->
    <sql id="CXBM" databaseId="mysql">
       <![CDATA[	
			]]>
    </sql>

    <!--数据查询[CXBM]-->
    <sql id="CXBM" databaseId="oracle">
       <![CDATA[	SELECT ( substr(t1.ORGCODE,1,3) ) AS ADMCODING, ( select  ormerporgname   from  t_ormerporg  t  where  t.ormerporgid = t1.OUID ) AS BELONGOU, t1.CREATEDATE, t1.CREATEMAN, t1.NUMCOMP, t1.DATEFROM, t1.DATETO, t1.ISENABLE, t1.LASTUPDATEDATE, t1.ORDERNUM, t1.ORGADDRESSLINE1, t1.ORGADDRESSLINE2, t1.ORGADDRESSLINE3, t1.ORGCODE, t1.ORGCREATEDATE, t1.ORGSHORTNAME, t1.ORGTYPE, t1.ORGTYPENAME, t1.ORGZIPCODE, t1.ORMERPORGID, t1.ORMERPORGNAME, t1.OUCODE, t1.OUID, t1.PARENTORGID, t1.TOWNCITY, t1.UPDATEDATE, t1.UPDATEMAN, t1.YYFLAG FROM T_ORMERPORG t1  
				 WHERE 	( (t1.ORGTYPE = 'CCEED6'  or t1.ORGTYPE = 'CCEED9')  and  t1.ISENABLE=1 and  (instr(t1.orgcode,(select a.orgcode from v_ormorg a where a.orgid = #{srf.webcontext.nodeid')}))=1)  and  ( ( substr(t1.ORGCODE,1,3)    in   (select  substr(a.orgcode,1,3)  from  t_srforg  a  where  a.orgid = #{srf.sessioncontext.SRFORGID')}  ))  or   ('ibzadmin' = (select t.loginaccountname from t_srfloginaccount t where t.loginaccountid = #{srf.sessioncontext.SRFPERSONID')} ) )  or  ( (select substr(a.orgcode, 1, 3)    from t_srforg a  where a.orgid = #{srf.sessioncontext.SRFORGID')} )  in  ('BG','100') )  ) )
			]]>
    </sql>

    <!--数据查询[CXZBM]-->
    <sql id="CXZBM" databaseId="mysql">
       <![CDATA[	
			]]>
    </sql>

    <!--数据查询[CXZBM]-->
    <sql id="CXZBM" databaseId="oracle">
       <![CDATA[	SELECT ( substr(t1.ORGCODE,1,3) ) AS ADMCODING, ( select  ormerporgname   from  t_ormerporg  t  where  t.ormerporgid = t1.OUID ) AS BELONGOU, t1.CREATEDATE, t1.CREATEMAN, t1.NUMCOMP, t1.DATEFROM, t1.DATETO, t1.ISENABLE, t1.LASTUPDATEDATE, t1.ORDERNUM, t1.ORGADDRESSLINE1, t1.ORGADDRESSLINE2, t1.ORGADDRESSLINE3, t1.ORGCODE, t1.ORGCREATEDATE, t1.ORGSHORTNAME, t1.ORGTYPE, t1.ORGTYPENAME, t1.ORGZIPCODE, t1.ORMERPORGID, t1.ORMERPORGNAME, t1.OUCODE, t1.OUID, t1.PARENTORGID, t1.TOWNCITY, t1.UPDATEDATE, t1.UPDATEMAN, t1.YYFLAG FROM T_ORMERPORG t1  
				 WHERE 	(t1.ORGTYPE = 'CCEED6' and t1.ISENABLE=1 and (instr(t1.orgcode,(select substr(a.orgcode,1,5) from v_ormorgsector a where a.orgsectorid = #{srf.webcontext.nodeid')}))=1))
			]]>
    </sql>

    <!--数据查询[Default]-->
    <sql id="Default" databaseId="oracle">
       <![CDATA[	SELECT ( substr(t1.ORGCODE,1,3)  ) AS ADMCODING, ( select  ormerporgname   from  t_ormerporg  t  where  t.ormerporgid = t1.OUID ) AS BELONGOU, t1.CREATEDATE, t1.CREATEMAN, t1.DATEFROM, t1.DATETO, t1.ISENABLE, t1.LASTUPDATEDATE, t1.NUMCOMP, t1.ORDERNUM, t1.ORGADDRESSLINE1, t1.ORGADDRESSLINE2, t1.ORGADDRESSLINE3, t1.ORGCODE, t1.ORGCREATEDATE, t1.ORGSHORTNAME, t1.ORGTYPE, t1.ORGTYPENAME, t1.ORGZIPCODE, t1.ORMERPORGID, t1.ORMERPORGNAME, t1.OUCODE, t1.OUID, t1.PARENTORGID, t1.TOWNCITY, t1.UPDATEDATE, t1.UPDATEMAN, t1.YYFLAG FROM T_ORMERPORG t1  
			]]>
    </sql>

    <!--数据查询[LegalChoice]-->
    <sql id="LegalChoice" databaseId="oracle">
       <![CDATA[	SELECT ( substr(t1.ORGCODE,1,3)  ) AS ADMCODING, ( select  ormerporgname   from  t_ormerporg  t  where  t.ormerporgid = t1.OUID ) AS BELONGOU, t1.CREATEDATE, t1.CREATEMAN, t1.DATEFROM, t1.DATETO, t1.ISENABLE, t1.LASTUPDATEDATE, t1.NUMCOMP, t1.ORDERNUM, t1.ORGADDRESSLINE1, t1.ORGADDRESSLINE2, t1.ORGADDRESSLINE3, t1.ORGCODE, t1.ORGCREATEDATE, t1.ORGSHORTNAME, t1.ORGTYPE, t1.ORGTYPENAME, t1.ORGZIPCODE, t1.ORMERPORGID, t1.ORMERPORGNAME, t1.OUCODE, t1.OUID, t1.PARENTORGID, t1.TOWNCITY, t1.UPDATEDATE, t1.UPDATEMAN, t1.YYFLAG FROM T_ORMERPORG t1  
				 WHERE 	( ( t1.orgtype  in  ('CCEED1','CCEED2','CCEED3','CCEED4','CCEED5','CCEED6','CCEED9') )  AND  ( ( length(  #{srf.datacontext.orgcode')} ) = 3   and   length( t1.orgcode ) =3 )  OR  ( length(  #{srf.datacontext.orgcode')} )  > 3   and  ( substr(t1.ORGCODE,1,3) )  in  (select  t.orgcode from t_ormrelation  t  where t.magunitid = #{srf.datacontext.porgid')} ) ) ) )
			]]>
    </sql>

</mapper>

